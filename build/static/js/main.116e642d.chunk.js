(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,a){e.exports=a(47)},36:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c),l=a(1),u=(a(36),a(24)),s=a(2),i=a(4),d=a(15);d().format();var m=Object(i.a)(function(e){return e.dates},function(e){return e.loading}),f=Object(i.a)(function(e){return e.dates.startMonth},function(e){return e.dates.currentYear},function(e,t){for(var a=[],n=function(n){var r=d([t,e,1]).add(n,"M"),c=Array.from({length:d(r).daysInMonth()},function(e,t){return d(r).startOf("month").add(t,"days")});a.push(c)},r=0;r<12;r++)n(r);return a}),b=Object(i.a)(function(e){return e.dates.bankHolidays},function(e){return e.reduce(function(e,t){return e[t.start]={hol:Object(s.a)({},t,{isBHoliday:!0})},e},{})}),O=Object(i.a)(function(e){return e.dates.holidays},b,function(e,t){var a=e.reduce(function(e){return function(t,a){var n=Object.keys(e),r=d(a.start,"YY-MM-DD"),c=d(a.end,"YY-MM-DD");c.isBefore(r,"day")&&(r=c,c=d(a.start,"YY-MM-DD"));for(var o=0,l=r.clone();r.isSameOrBefore(c,"day");)0===r.day()||6===r.day()||n.includes(r.format("YY-MM-DD"))||o++,r.add(1,"d");for(r=l;r.isSameOrBefore(c,"day");)0!==r.day()&&6!==r.day()&&(t[r.format("YY-MM-DD")]={hol:a,length:o}),r.add(1,"d");return t}}(t),{});return Object(s.a)({},a,t)}),E=function(e,t){return function(a){var n=d(a.start,"YY-MM-DD"),r=d("".concat(e,"-").concat(t+1,"-01"),"YYYY-MM-DD"),c=d("".concat(e+1,"-").concat(t+1,"-01"),"YYYY-MM-DD");return r<=n&&n<c&&a}},y=function(e){return function(t){var a=Object.keys(e),n=d(t.start,"YY-MM-DD"),r=d(t.end,"YY-MM-DD");r.isBefore(n,"day")&&(n=r,r=d(t.start,"YY-MM-DD"));for(var c=[];n.isSameOrBefore(r,"day");)0===n.day()||6===n.day()||a.includes(n.format("YY-MM-DD"))||c.push(n.format("YY-MM-DD")),n.add(1,"d");return c}},p=Object(i.a)(function(e){return e.dates.startDay},function(e){return e.dates.endOfCurrent},b,function(e,t,a){return[{start:e,end:t}].map(y(a)).flat()}),j=Object(i.a)(function(e){return e.dates.holidays},function(e){return e.dates.currentYear},function(e){return e.dates.startMonth},b,function(e,t,a,n){return e.filter(E(t,a)).map(y(n)).flat()}),h=Object(i.a)(function(e){return e.dates.bankHolidays},function(e){return e.dates.currentYear},function(e){return e.dates.startMonth},function(e,t,a){return e.filter(E(t,a)).map(function(e){return e.start})}),v=Object(i.a)(j,p,function(e,t){return e.length-t.length}),D=Object(i.a)(function(e){return e.dates.carriedOver},function(e){return e.dates.currentYear},function(e){return e.dates.daysPerYear},j,p,function(e,t,a,n,r){return(e[t]||0)+a-n.length-r.length}),Y=Object(i.a)(function(e){return e.dates.selected},O,function(e,t){return!!e&&t[e.formattedDay]}),k=Object(i.a)(function(e){return e.dates.daysPerYear},function(e){return e||0}),C=Object(i.a)(function(e){return e.dates.currentYear},function(e,t){return e.dates.carriedOver},function(e,t){return t[e]||0}),_=Object(i.a)(function(e){return e.dates.currentYear},function(e){return e||0}),A=Object(i.a)(function(e){return e.dates.startDay},function(e){return""!==e}),g=Object(i.a)(function(e){return e.dates.startDay},function(e){return e||""}),M=function(e){return e.auth.ww},N=Object(i.a)(M,function(e){return!(!e||!e.tokenObj)}),T=(Object(i.a)(M,function(e){return e&&e.Qt?e.Qt.Bd:""}),Object(i.a)(M,function(e){return e&&e.tokenObj?e.tokenObj.id_token:""})),S=a(8),w=a.n(S),R=a(13),H=a(49),L=a(11),I={loading:!1,startMonth:9,currentYear:2019,daysPerYear:30,carriedOver:{2019:0},startDay:"",endOfCurrent:"",selected:null,holidays:[],bankHolidays:[{start:"20-12-25",name:"xmas"}],bankHolidayCountry:"uk"},F=Object(H.a)("DATES_DESELECT"),x=Object(H.a)("FETCH_DATES_FROM_SERVER"),B=Object(H.a)("LOAD_DATES_FROM_SERVER"),P=Object(H.a)("ADD_NEW_BANK_HOLIDAY"),G=Object(H.a)("UPDATE_BANK_HOLIDAYS"),U=Object(H.a)("DATES_SELECT_HOLIDAY"),z=Object(H.a)("DATES_UPDATE_PER_YEAR",function(e){return e}),J=Object(H.a)("DATES_UPDATE_CARRIED_OVER"),V=function(e){return function(){var t=Object(R.a)(w.a.mark(function t(a,n){var r,c,o,l,u;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n(),""===(c=r.dates).startDay?(l=e,o=c.holidays):(l="",o=[].concat(Object(L.a)(c.holidays),[{start:c.startDay,end:e}])),u=Object(s.a)({},c,{startDay:l,holidays:Object(L.a)(o),endOfCurrent:""}),t.next=6,a({type:"DATES_SELECT_DAY",payload:u});case 6:""!==c.startDay&&a(W(JSON.stringify(Object(s.a)({},u,{selected:""})),r));case 7:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},W=function(e,t){return function(a){console.log(t);var n=T(t);return fetch("https://78b76ebpsj.execute-api.us-west-2.amazonaws.com/dev/holidays",{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}})}},K=Object(H.a)("LOGIN_AND_LOAD_DATA",function(){var e=Object(R.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye.dispatch({type:"LOGIN",payload:t});case 2:Ye.dispatch((t.tokenObj.id_token,function(e,t){var a=T(t());return e(x()),fetch("https://78b76ebpsj.execute-api.us-west-2.amazonaws.com/dev/holidays",{method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){return e(B(t))}).catch(function(t){return e(B({text:I}))})}));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Q=(a(39),function(){var e=Object(l.c)(f),t=Object(l.c)(N),a=Object(l.c)(m),c=Object(l.b)(),o=Object(n.useCallback)(function(e){return c(K(e))},[c]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,null),r.a.createElement("div",{className:"container"},a?r.a.createElement("div",{className:"loader"}):t?e.map(function(e){return r.a.createElement(ue,{key:e,month:e})}):r.a.createElement("div",{className:"welcome"},r.a.createElement("p",null,"Welcome to the new trackmyholidays.com"),r.a.createElement("p",null,"Here you can track you holidays in one yearly view, making it easy to see how many days you have left to plan"),r.a.createElement("p",null,"Please log in with your google account, so we can sync your holidays and allow you to access them on any device"),r.a.createElement(u.GoogleLogin,{clientId:"195751140228-9tkaoajmqv2ghuh0p1gs0a974aufffuo.apps.googleusercontent.com",render:function(e){return r.a.createElement("button",{onClick:e.onClick,disabled:e.disabled},"Login with Google")},buttonText:"Login",onSuccess:o,onFailure:o,cookiePolicy:"single_host_origin"}))),r.a.createElement(ae,null))}),q=a(3),$=a(7),X={uk:{display:"UK",dates:[{date:""}]},usa:{display:"USA"}},Z=function(e){return!!e&&e.config.configIsOpen},ee=(a(40),a(41),a(15));ee().format();var te=function(){var e=Object(l.c)(Z),t=Object(l.c)(C),a=Object(l.c)(k),c=Object(l.c)(h),o=Object(l.c)(O),u=c.reduce(function(e,t,a){return Object(s.a)({},e,Object(q.a)({},a,{key:a,name:o[t].hol.name,start:o[t].hol.start}))},{}),i=Object(l.b)(),d=Object(n.useCallback)(function(){i({type:"CHANGE_CONFIG"}),document.body.classList.remove("modal-open")},[i]),m=Object(n.useCallback)(function(e){return i({type:"DATES_SELECT_START_MONTH",payload:e})},[i]),f=Object(n.useCallback)(function(e){return i(z(e))},[i]),b=Object(n.useCallback)(function(e){return i(J(e))},[i]),E=Object(n.useCallback)(function(e){var t=e.target,a=t.name,n=t.value;e.persist();var r=Object(s.a)({},u[a],{start:"text"===t.type?u[a].start:n,name:"text"===t.type?n:u[a].name});i(G(Object.values(Object(s.a)({},u,Object(q.a)({},a,r))).map(function(e){return{name:e.name,start:10===e.start.length?e.start.slice(2):e.start}})))},[i,u]),y=Object(n.useCallback)(function(e){e.persist(),i(P())},[i]);return e?r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"controls"},r.a.createElement($.d,null,r.a.createElement($.b,null,r.a.createElement($.a,null,"Dates"),r.a.createElement($.a,null,"Bank Holidays"),r.a.createElement($.a,{onClick:d},"Close")),r.a.createElement($.c,null,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"control"},r.a.createElement("h4",null,"Choose your holiday year start month:"),r.a.createElement("button",{onClick:function(){return m(0)}},"Jan"),r.a.createElement("button",{onClick:function(){return m(1)}},"Feb"),r.a.createElement("button",{onClick:function(){return m(2)}},"Mar"),r.a.createElement("button",{onClick:function(){return m(3)}},"Apr"),r.a.createElement("button",{onClick:function(){return m(4)}},"May"),r.a.createElement("button",{onClick:function(){return m(5)}},"Jun"),r.a.createElement("button",{onClick:function(){return m(6)}},"Jul"),r.a.createElement("button",{onClick:function(){return m(7)}},"Aug"),r.a.createElement("button",{onClick:function(){return m(8)}},"Sept"),r.a.createElement("button",{onClick:function(){return m(9)}},"Oct"),r.a.createElement("button",{onClick:function(){return m(10)}},"Nov"),r.a.createElement("button",{onClick:function(){return m(11)}},"Dec")),r.a.createElement("div",{className:"control"},r.a.createElement("label",{htmlFor:"py"},"Holidays per year: "),r.a.createElement("input",{id:"py",type:"number",onChange:function(e){return f(e.target.value)},value:a})),r.a.createElement("div",{className:"control"},r.a.createElement("label",{htmlFor:"co"},"Carried Over: "),r.a.createElement("input",{id:"co",type:"number",onChange:function(e){return b(e.target.value)},value:t})))),r.a.createElement($.c,{className:"bh"},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"control"},r.a.createElement("label",{for:"reset-dates"},"Reset bank holiday dates to country:"),r.a.createElement("select",{id:"reset-dates",value:"uk",onChange:function(){}},Object.keys(X).map(function(e){return{key:e,display:X[e].display}}).map(function(e){return r.a.createElement("option",{key:e.key,value:e.key},e.display)})),r.a.createElement("button",{onClick:d},"Reset")),Object.values(u).map(function(e){return r.a.createElement("div",{key:e.key,className:"control"},r.a.createElement("input",{type:"date",name:e.key,value:ee(e.start,"YY-MM-DD").format("YYYY-MM-DD"),onChange:E}),r.a.createElement("input",{type:"text",name:e.key,value:e.name,onChange:E}))}),r.a.createElement("div",{className:"control"},r.a.createElement("button",{onClick:y},"Add new date")))),r.a.createElement($.c,null)))):null},ae=(a(42),function(){var e=Object(l.c)(Y),t=Object(l.b)(),a=Object(n.useCallback)(function(e){return t((a=e,function(){var e=Object(R.a)(w.a.mark(function e(t,n){var r;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(F(a));case 2:r=n(),t(W(JSON.stringify(Object(s.a)({},r.dates,{selected:""})),r));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()));var a},[t]);return e?r.a.createElement("footer",null,e.hol.isBHoliday?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"from"},e.hol.name,": ",e.hol.start)):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"from"},"From: ",e.hol.start),r.a.createElement("span",{className:"to"},"To: ",e.hol.end),r.a.createElement("span",{className:"length"},"(",e.length," days)"),r.a.createElement("button",{onClick:a.bind(null,e)},"Deselect"))):null}),ne=(a(43),a(15)),re=function(e){var t=e.day,a=ne(t),c=a.format("YY-MM-DD"),o="0"===a.format("d")||"6"===a.format("d"),u=Object(l.b)(),s=Object(l.c)(j),i=Object(l.c)(h),d=s.indexOf(c)>-1,m=d?"hol":"",f=i.indexOf(c)>-1,b=f?"bhol":"",O=Object(l.c)(p).indexOf(c)>-1?"provhol":"",E=Object(l.c)(A),y=E&&!o?"select-mode":"",v=Object(l.c)(g)===c?"start-of-hol":"",D=V,Y=c;(d||f)&&(D=U,Y={formattedDay:c,isBHoliday:f}),o&&(D=!1);var k=Object(n.useCallback)(function(){return D?u(D(Y)):null},[u,D,Y]),C=!1;E&&(C={type:"DATES_SELECT_END_OF_CURRENT",payload:c});var _=Object(n.useCallback)(function(){return C?u(C):null},[u,C]);return r.a.createElement("button",{className:"day day-".concat(a.format("d")," ").concat(v," ").concat(y," ").concat(O," ").concat(m," ").concat(b),onClick:k,onMouseOver:_},a.format("DD"))},ce=a(17),oe=(a(44),function(){var e=Object(l.c)(D),t=Object(l.c)(v),a=Object(l.c)(_),c=Object(l.c)(N),o=Object(l.b)(),u=Object(n.useCallback)(function(e){return o({type:"DATES_CHANGE_YEAR",payload:e})},[o]),s=Object(n.useCallback)(function(){o({type:"CHANGE_CONFIG"}),document.body.classList.add("modal-open")},[o]);return r.a.createElement("header",null,c?r.a.createElement("span",{className:"header-controls"},r.a.createElement("span",{className:"settings"},r.a.createElement("button",{onClick:s},r.a.createElement(ce.c,{color:"white",size:"2em"}))),r.a.createElement("span",{className:"year"},r.a.createElement("button",{label:"previous year",onClick:u.bind(null,-1)},r.a.createElement(ce.a,{color:"white",size:"2em"})),r.a.createElement("span",{className:"currentYear"},a," - ",a+1),r.a.createElement("button",{label:"next year",onClick:u.bind(null,1)},r.a.createElement(ce.b,{color:"white",size:"2em"}))),r.a.createElement("div",{className:"stats-group"},r.a.createElement("span",{className:"stats-small"},"Planned: ",t," "),r.a.createElement("span",{className:"stats"},"Left to plan: ",e," "))):r.a.createElement("span",{className:"header-controls"},r.a.createElement("span",{className:"settings"},"Trackmyholidays.com")))}),le=(a(45),a(15)),ue=function(e){var t=e.month;return r.a.createElement("div",{className:"month"},r.a.createElement("h3",null,le(t[0]).format("MMMM YYYY")),r.a.createElement("span",{className:"dow"},"M"),r.a.createElement("span",{className:"dow"},"T"),r.a.createElement("span",{className:"dow"},"W"),r.a.createElement("span",{className:"dow"},"T"),r.a.createElement("span",{className:"dow"},"F"),r.a.createElement("span",{className:"dow"},"S"),r.a.createElement("span",{className:"dow"},"S"),t.map(function(e){return r.a.createElement(re,{key:e,day:e})}))};a(46);var se=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Q,null),r.a.createElement(te,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie,de=a(9),me=a(25),fe=a(26),be=a.n(fe),Oe=a(48),Ee={ww:{}},ye=Object(Oe.a)(Object(q.a)({},"LOGIN",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=(arguments.length>1?arguments[1]:void 0).payload;return Object(s.a)({},e,{ww:t})}),Ee),pe={configIsOpen:!1},je=Object(Oe.a)(Object(q.a)({},"CHANGE_CONFIG",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe;(arguments.length>1?arguments[1]:void 0).payload;return Object(s.a)({},e,{configIsOpen:!e.configIsOpen})}),pe);if("number"===typeof I.carriedOver){var he=I.carriedOver;I.carriedOver={},I[I.currentYear]=he}var ve=Object(Oe.a)((ie={},Object(q.a)(ie,"FETCH_DATES_FROM_SERVER",function(e,t){t.payload;return Object(s.a)({},e,{loading:!0})}),Object(q.a)(ie,"ADD_NEW_BANK_HOLIDAY",function(e){return Object(s.a)({},e,{bankHolidays:[].concat(Object(L.a)(e.bankHolidays),[{start:"".concat(String(e.currentYear).slice(2,4),"-").concat(e.startMonth+1,"-01"),name:"a"}])})}),Object(q.a)(ie,"UPDATE_BANK_HOLIDAYS",function(e,t){var a,n,r=t.payload,c=e.bankHolidays.filter((a=e.currentYear,n=e.startMonth,function(e){var t=d(e.start,"YY-MM-DD"),r=d("".concat(a,"-").concat(n+1,"-01"),"YYYY-MM-DD"),c=d("".concat(a+1,"-").concat(n+1,"-01"),"YYYY-MM-DD");return!(r<=t&&t<c)&&e}));return Object(s.a)({},e,{bankHolidays:[].concat(Object(L.a)(c),Object(L.a)(r))})}),Object(q.a)(ie,"LOAD_DATES_FROM_SERVER",function(e,t){var a=t.payload.text;return Object(s.a)({},e,{startMonth:a.startMonth,currentYear:a.currentYear,daysPerYear:a.daysPerYear,carriedOver:a.carriedOver,holidays:a.holidays,bankHolidays:a.bankHolidays,loading:!1})}),Object(q.a)(ie,"DATES_SELECT_DAY",function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(arguments.length>1?arguments[1]:void 0).payload}),Object(q.a)(ie,"DATES_SELECT_END_OF_CURRENT",function(e,t){var a=t.payload;return Object(s.a)({},e,{endOfCurrent:a})}),Object(q.a)(ie,"DATES_UPDATE_PER_YEAR",function(e,t){var a=t.payload;return Object(s.a)({},e,{daysPerYear:parseInt(a)})}),Object(q.a)(ie,"DATES_UPDATE_CARRIED_OVER",function(e,t){var a=t.payload;return Object(s.a)({},e,{carriedOver:Object(s.a)({},e.carriedOver,Object(q.a)({},e.currentYear,parseInt(a)))})}),Object(q.a)(ie,"DATES_SELECT_START_MONTH",function(e,t){var a=t.payload;return Object(s.a)({},e,{startMonth:a})}),Object(q.a)(ie,"DATES_SELECT_HOLIDAY",function(e,t){var a=t.payload;return Object(s.a)({},e,{selected:a})}),Object(q.a)(ie,"DATES_CHANGE_YEAR",function(e,t){var a=t.payload;return Object(s.a)({},e,{currentYear:e.currentYear+a,startDay:""})}),Object(q.a)(ie,"DATES_DESELECT",function(e,t){var a=t.payload;return Object(s.a)({},e,{holidays:e.holidays.filter(function(e){return e.start!==a.hol.start})})}),ie),I),De=Object(de.c)({auth:ye,config:je,dates:ve});a.d(t,"storeInstance",function(){return Ye});var Ye=Object(de.d)(De,Object(de.a)(me.a,be.a));o.a.render(r.a.createElement(l.a,{store:Ye},r.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.116e642d.chunk.js.map